<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SLD App - Web Demo</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; background: #f8f9fa; }
        .header { background: #6C63FF; color: white; padding: 1rem 2rem; }
        .container { max-width: 400px; margin: 2rem auto; padding: 2rem; }
        .form { background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 0.75rem; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 4px; }
        button { width: 100%; padding: 0.75rem; margin-bottom: 0.5rem; border: none; border-radius: 4px; cursor: pointer; }
        .primary { background: #6C63FF; color: white; }
        .secondary { background: #f8f9fa; color: #666; border: 1px solid #ddd; }
        .success { background: #4CAF50; color: white; padding: 1rem; border-radius: 4px; margin-bottom: 1rem; }
        .error { background: #f44336; color: white; padding: 1rem; border-radius: 4px; margin-bottom: 1rem; }
    </style>
</head>
<body>
    <div class="header">
        <h1>SLD App - Web Demo</h1>
    </div>
    
    <div class="container">
        <div id="status" style="margin-bottom: 1rem;"></div>
        
        <div id="auth-form" class="form">
            <h2 id="form-title">Login</h2>
            
            <input type="text" id="name" placeholder="Name" style="display: none;">
            <input type="email" id="email" placeholder="Email" required>
            <input type="password" id="password" placeholder="Password" required>
            
            <button class="primary" onclick="handleAuth()">Login</button>
            <button class="secondary" onclick="toggleMode()">Switch to Register</button>
        </div>
        
        <div id="dashboard" style="display: none;">
            <div class="form">
                <h2>Welcome!</h2>
                <p>‚úÖ Authentication working</p>
                <p>‚úÖ Backend connected</p>
                <p>üì± Full mobile features available in React Native app</p>
                <button class="secondary" onclick="logout()">Logout</button>
            </div>
        </div>
    </div>

    <script>
        let isLogin = true;
        let currentUser = null;

        function toggleMode() {
            isLogin = !isLogin;
            document.getElementById('form-title').textContent = isLogin ? 'Login' : 'Register';
            document.getElementById('name').style.display = isLogin ? 'none' : 'block';
            document.querySelector('.primary').textContent = isLogin ? 'Login' : 'Register';
            document.querySelector('.secondary').textContent = `Switch to ${isLogin ? 'Register' : 'Login'}`;
        }

        async function handleAuth() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const name = document.getElementById('name').value;
            
            const endpoint = isLogin ? '/api/auth/login' : '/api/auth/register';
            const body = isLogin ? { email, password } : { email, password, name };
            
            try {
                showStatus('Connecting...', 'info');
                
                const response = await fetch(`http://localhost:3002${endpoint}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    currentUser = data.user;
                    showDashboard();
                    showStatus(`${isLogin ? 'Login' : 'Registration'} successful!`, 'success');
                } else {
                    showStatus(data.error || 'Authentication failed', 'error');
                }
            } catch (error) {
                showStatus('Backend not running. Start with: cd backend && node src/server-simple.js', 'error');
            }
        }

        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.innerHTML = `<div class="${type}">${message}</div>`;
            if (type !== 'error') {
                setTimeout(() => status.innerHTML = '', 3000);
            }
        }

        function showDashboard() {
            document.getElementById('auth-form').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
        }

        function logout() {
            currentUser = null;
            document.getElementById('auth-form').style.display = 'block';
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('email').value = '';
            document.getElementById('password').value = '';
            document.getElementById('name').value = '';
            showStatus('Logged out', 'info');
        }

        // Test backend connection on load
        window.onload = async function() {
            try {
                const response = await fetch('http://localhost:3002/health');
                if (response.ok) {
                    showStatus('‚úÖ Backend connected', 'success');
                } else {
                    showStatus('‚ùå Backend error', 'error');
                }
            } catch (error) {
                showStatus('‚ùå Backend not running. Start with: cd backend && node src/server-simple.js', 'error');
            }
        };
    </script>
</body>
</html>